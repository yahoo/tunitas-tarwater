<?php
    // Adapted from  https://github.com/digi-trust/dt-cdn/wiki/ID-encryption
    $pemPrivateKey = '-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCCt0VZvTt5AVG1
2ZdydVGlJkWiJs0UxkMRkefvWPqhrk6HDuaK78KmXvuHY+n/Rsu3d0evpFyKeoD1
xyTac+MkTDay9LMk4djXjT0LGvtzICF+a54trMv8LwM7IVJ7d7hAY2wm09OU3LoS
2advh29y2mb+dDacNo/DnCdvSFYjoiTvC2+Nsf1JoJGVdzIQqkXWhfLnmMMl6i9L
FDP14v5uA5sPYvPjeCJ1TgH/M+Fs0j4qYyRXnf2iTIV+ZwHCsJABGSH13d4jyQAf
4+m1NqUClUB589IZl1aRK+Q3DscRtycsxZZZcp4XvPaUwF3tFucLIFSaC0ctjp3w
dfok9YHpAgMBAAECggEAIsLB+n9MFX24UPewQovYTmbDFb/jwaaHp2B5oTi0TdKg
p2HbBQ+FX+DaWsLDM1OMURmzQo4e3eR97t4qer1epgRud2CDU0eL9qZkmVNvksn0
nj3YLqVJCaMm5M6TtKm9ocHOvPSPy4J3KRQgZpRJmu1hfkFBVIFd8dLQ2dMOtSK/
iBvVgY0vf607DITj8r946hT/aPr6rd31P1YFtGUeY5PEwybWxadd/khanceyND8N
TOgWmLbCzun2PzTkr7kP76z8QnfqOyFcqyfSZGV5Bg00TB2PILkkxqEhzakAZABP
i5ijaVzP7QHB2Ae/UY+7VMC3RTr6O2Mi7qVk0bwGUQKBgQD30BQ9Ia8ojuneExn4
onhTdpMxzeuUhAbxAMkKuj+OVnfkqqjRwAqHnG5bGASL/C3dowyBcLoK4RJiu3tj
zbk3hs8xqcYKoaeFd06MiYUJL5nkfnNoFjI1RLgznR5uU5NRFZAh/sa0qYSWj1DR
SE4QLm2t9HBuTfsdaA2G0ZvZ2wKBgQCHCNLrt9NXNrynf09K09n+dKk6hRstrgpy
VDvtj2IPbZd1bNddl527Mo9CsVSV1mOa7smSBvOGj3MNppzTpp5k3Ud4y6ZbqPl4
H9nZyfwIHlVHwD+O/vv+V5ZohoIXGPdsY9Lvay2+ZPiGL7d58KcKnnl7I4t2As9I
GdMKsaQoiwKBgCbdJS9pJvUvZJIFYN9Ta5d7Ux5OcxG5mvUU8HKUPv9tpCPid9Nd
UMlvyQbUP3JMvEy0E3QBX8vw/Fcrm/BNBS0mITxiqcJlE8akrVbxAkIsivAAvMyo
HnuoKVM+4tTemo3u2cnbEQKoSzjphP0tX8C950mOuksyQ52bAfQQz2ZdAoGAKvwW
GE8WCYc1GqSeGxXBKQz96dEBS9NBJA/IW+DuuDaMpiaVkAd5gGOh0vscD+6FGoa0
x7VKxCTZ3RiSh5VcioMeA0fglwD9GM4azQdNIVB2mTaLhPuKP/alvHRE6RFbgbdt
KCWYFCmUKzL5VunSYsD7rsUr2c8fKLZ/xcGyne0CgYEAr2b6uTDtZAzFmpRViLGx
rYFns5/mtRpbE5D6L9Rvddi1X+A+qYQ7ymmy4Av32cCiV4z35/prl1zyEE6PNxq/
ksOP3lQCdTbCvoX+UbmKtRcZiWunJf3NJAiwuYT2EcSXF7Wz/8uWuUZHHFFwEYkP
j1siqFQ1K89ZBf2v8zgSXoU=
-----END PRIVATE KEY-----';

    $base64Ciphertext =  'F6vrzeiV625KD2WaTcGs68ajfRYokPFm6jNUSsawIKAdo/K8vOCPQ24l7hvEatiOBnsBOABTCjmcMe7C2PkzWgZ4zQeZ6qA5ZfmOVfRbdWjxSO2T+wAuMrLkczqHeXCSLBlR4iyz5ho1o44IPwXyxuYI7iXehBk7F/4QJvnSmK1pCyhp+7UszarryqwGVAjIwwekBxmYm/sU8OZeiUOe8iLa/ggQwf0S1Gl5WpFB7IecyrxGF5fu1jRsbmiF5viYTDUBAiq9Q5TlnA2uawkaNYJGmFT83GEIbYjt27ZiEXMru1NzzaaQBdZA1u97LPDQekj/bvCARwQxbrr1P/uJbA==';

    $privateKey = openssl_get_privatekey($pemPrivateKey);
    
    $binaryCiphertext = base64_decode($base64Ciphertext);
    $b = openssl_private_decrypt($binaryCiphertext, $decr, $privateKey, OPENSSL_PKCS1_OAEP_PADDING);
    echo "Decrypted ID: " . $decr;
?>